<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Manager</title>
    <meta name="description" content="Track your income, expenses, and savings with this personal finance manager.">
    <meta name="theme-color" content="#111111">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23111'/><text x='50' y='50' font-size='50' text-anchor='middle' dominant-baseline='middle' fill='%23fff' font-family='Arial'>FM</text></svg>">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <!-- App styles -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header id="app-header" style="display: none;">
        <h1 id="page-title">Dashboard</h1>
        <div style="display: flex; gap: 10px; margin-left: auto;">
            <button id="settings-btn" class="header-icon-btn" title="Settings">
                <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                    width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="square" stroke-linejoin="round" stroke-width="2"
                        d="M10 19H5a1 1 0 0 1-1-1v-1a3 3 0 0 1 3-3h2m10 1a3 3 0 0 1-3 3m3-3a3 3 0 0 0-3-3m3 3h1m-4 3a3 3 0 0 1-3-3m3 3v1m-3-4a3 3 0 0 1 3-3m-3 3h-1m4-3v-1m-2.121 1.879-.707-.707m5.656 5.656-.707-.707m-4.242 0-.707.707m5.656-5.656-.707.707M12 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
            </button>
        </div>
    </header>

    <main id="app"></main>

    <!-- Bottom navigation -->
    <nav id="bottom-nav" style="display: none;">
        <a href="#/dashboard" class="nav-item" data-page="dashboard">
            <span class="nav-icon">&#9673;</span>
            <span class="nav-label">Dashboard</span>
        </a>
        <a href="#/records" class="nav-item" data-page="records">
            <span class="nav-icon">&#9776;</span>
            <span class="nav-label">Records</span>
        </a>
        <a href="#/files" class="nav-item" data-page="files">
            <span class="nav-icon">&#128196;</span>
            <span class="nav-label">Files</span>
        </a>
    </nav>

    <!-- Modal container -->
    <div id="modal-overlay" class="modal-overlay hidden">
        <div id="modal" class="modal">
            <div class="modal-header">
                <h2 id="modal-title"></h2>
                <button id="modal-close" class="modal-close">&times;</button>
            </div>
            <div id="modal-body" class="modal-body"></div>
        </div>
    </div>

    <!-- Scripts (order matters: db → dao → services → views → controllers → router → app) -->
    <script src="js/db.js"></script>
    <script src="js/services/authService.js"></script>
    <script src="js/views/authView.js"></script>
    <script src="js/controllers/authController.js"></script>
    <script src="js/dao/settingsDao.js"></script>
    <script src="js/dao/tagDao.js"></script>
    <script src="js/dao/recordDao.js"></script>
    <script src="js/dao/fileDao.js"></script>
    <script src="js/dao/recordAttachmentDao.js"></script>
    <script src="js/services/tagService.js"></script>
    <script src="js/services/settingsService.js"></script>
    <script src="js/services/recordService.js"></script>
    <script src="js/services/fileService.js"></script>
    <script src="js/services/widgetService.js"></script>
    <script src="js/services/backupService.js"></script>
    <script src="js/services/googleDriveService.js"></script>
    <script src="js/utils/dateFilterUtil.js"></script>
    <script src="js/views/recordsView.js"></script>
    <script src="js/views/filesView.js"></script>
    <script src="js/views/dateFilterView.js"></script>
    <script src="js/views/backupView.js"></script>
    <script src="js/views/dashboardView.js"></script>
    <script src="js/views/settingsView.js"></script>
    <script src="js/controllers/recordsController.js"></script>
    <script src="js/controllers/filesController.js"></script>
    <script src="js/controllers/dashboardController.js"></script>
    <script src="js/controllers/settingsController.js"></script>
    <script src="js/router.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>

</html>